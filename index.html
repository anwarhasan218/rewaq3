<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام تسجيل دارسي العلوم الشرعية والعربية</title>
    <!-- Bootstrap RTL CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Fonts - Tajawal -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card shadow-lg border-0 rounded-lg">
                    <div class="card-header bg-primary text-white text-center py-4">
                        <h1 class="fs-4 fw-bold mb-0">استمارة تسجيل دارسي العلوم الشرعية والعربية</h1>
                        <p class="mb-0 mt-2">يرجى ملء جميع البيانات المطلوبة بدقة</p>
                    </div>
                    <div class="card-body p-4">
                        <!-- البحث عن بيانات مسجلة مسبقاً -->
                        <div class="mb-4 p-3 bg-light rounded">
                            <h5 class="mb-3">البحث عن بيانات مسجلة مسبقاً</h5>
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="searchTerm" placeholder="أدخل الرقم القومي أو رقم الجلوس للبحث">
                                        <button class="btn btn-primary" type="button" id="searchBtn">
                                            <i class="fas fa-search me-1"></i> بحث
                                        </button>
                                    </div>
                                    <small class="text-muted">يمكنك البحث باستخدام الرقم القومي أو رقم الجلوس لاسترجاع بياناتك المسجلة مسبقاً</small>
                                </div>
                                <div class="col-md-4 text-end">
                                    <button class="btn btn-outline-secondary" type="button" id="newRegistrationBtn">
                                        <i class="fas fa-plus-circle me-1"></i> تسجيل جديد
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- رسائل النجاح والخطأ -->
                        <div class="alert alert-success d-none" id="successMessage">
                            تم تسجيل البيانات بنجاح!
                        </div>
                        <div class="alert alert-danger d-none" id="errorMessage">
                            حدث خطأ أثناء تسجيل البيانات. يرجى المحاولة مرة أخرى.
                        </div>
                        <div class="alert alert-info d-none" id="searchMessage">
                            جاري البحث...
                        </div>

                        <!-- نموذج التسجيل -->
                        <form id="registrationForm">
                            <div class="row">
                                <!-- المحافظة -->
                                <div class="col-md-6 mb-3">
                                    <label for="governorate" class="form-label">المحافظة</label>
                                    <select class="form-select" id="governorate" name="governorate" required>
                                        <option value="">اختر المحافظة</option>
                                        <option value="القاهرة">القاهرة</option>
                                        <option value="الجيزة">الجيزة</option>
                                        <option value="الإسكندرية">الإسكندرية</option>
                                        <option value="البحيرة">البحيرة</option>
                                        <option value="كفر الشيخ">كفر الشيخ</option>
                                        <option value="الغربية">الغربية</option>
                                        <option value="المنوفية">المنوفية</option>
                                        <option value="القليوبية">القليوبية</option>
                                        <option value="الدقهلية">الدقهلية</option>
                                        <option value="دمياط">دمياط</option>
                                        <option value="الشرقية">الشرقية</option>
                                        <option value="بورسعيد">بورسعيد</option>
                                        <option value="الإسماعيلية">الإسماعيلية</option>
                                        <option value="السويس">السويس</option>
                                        <option value="شمال سيناء">شمال سيناء</option>
                                        <option value="جنوب سيناء">جنوب سيناء</option>
                                        <option value="بني سويف">بني سويف</option>
                                        <option value="الفيوم">الفيوم</option>
                                        <option value="المنيا">المنيا</option>
                                        <option value="أسيوط">أسيوط</option>
                                        <option value="سوهاج">سوهاج</option>
                                        <option value="قنا">قنا</option>
                                        <option value="الأقصر">الأقصر</option>
                                        <option value="أسوان">أسوان</option>
                                        <option value="الوادي الجديد">الوادي الجديد</option>
                                        <option value="مطروح">مطروح</option>
                                        <option value="البحر الأحمر">البحر الأحمر</option>
                                    </select>
                                    <div class="invalid-feedback">يرجى اختيار المحافظة</div>
                                </div>

                                <!-- رقم الجلوس -->
                                <div class="col-md-6 mb-3">
                                    <label for="seatNumber" class="form-label">رقم الجلوس</label>
                                    <input type="text" class="form-control" id="seatNumber" name="seatNumber">
                                    <div class="invalid-feedback">يرجى إدخال رقم الجلوس</div>
                                </div>

                                <!-- الاسم رباعي -->
                                <div class="col-md-6 mb-3">
                                    <label for="fullName" class="form-label">الاسم رباعي كما في البطاقة الشخصية</label>
                                    <input type="text" class="form-control" id="fullName" name="fullName" required>
                                    <div class="invalid-feedback">يرجى إدخال الاسم الرباعي</div>
                                </div>

                                <!-- الرقم القومي -->
                                <div class="col-md-6 mb-3">
                                    <label for="nationalId" class="form-label">الرقم القومي</label>
                                    <input type="text" class="form-control" id="nationalId" name="nationalId" required pattern="[0-9]{14}">
                                    <div class="invalid-feedback">يرجى إدخال الرقم القومي المكون من 14 رقم</div>
                                </div>

                                <!-- رقم جواز السفر -->
                                <div class="col-md-6 mb-3">
                                    <label for="passportNumber" class="form-label">رقم جواز السفر (اختياري)</label>
                                    <input type="text" class="form-control" id="passportNumber" name="passportNumber">
                                </div>

                                <!-- رقم الهاتف -->
                                <div class="col-md-6 mb-3">
                                    <label for="phoneNumber" class="form-label">رقم الهاتف (عليه واتساب)</label>
                                    <input type="tel" class="form-control" id="phoneNumber" name="phoneNumber" required>
                                    <div class="invalid-feedback">يرجى إدخال رقم الهاتف</div>
                                </div>

                                <!-- النوع -->
                                <div class="col-md-6 mb-3">
                                    <label for="gender" class="form-label">النوع</label>
                                    <select class="form-select" id="gender" name="gender" required>
                                        <option value="">اختر النوع</option>
                                        <option value="male">ذكر</option>
                                        <option value="female">أنثى</option>
                                    </select>
                                    <div class="invalid-feedback">يرجى اختيار النوع</div>
                                </div>

                                <!-- السن -->
                                <div class="col-md-6 mb-3">
                                    <label for="age" class="form-label">السن</label>
                                    <input type="number" class="form-control" id="age" name="age" required min="15" max="100">
                                    <div class="invalid-feedback">يرجى إدخال السن</div>
                                </div>

                                <!-- محل الإقامة -->
                                <div class="col-md-6 mb-3">
                                    <label for="residenceAddress" class="form-label">محل الإقامة</label>
                                    <input type="text" class="form-control" id="residenceAddress" name="residenceAddress" required>
                                    <div class="invalid-feedback">يرجى إدخال محل الإقامة</div>
                                </div>

                                <!-- المؤهل الدراسي -->
                                <div class="col-md-6 mb-3">
                                    <label for="educationalQualification" class="form-label">المؤهل الدراسي</label>
                                    <input type="text" class="form-control" id="educationalQualification" name="educationalQualification" required>
                                    <div class="invalid-feedback">يرجى إدخال المؤهل الدراسي</div>
                                </div>

                                <!-- نوع التعليم -->
                                <div class="col-md-6 mb-3">
                                    <label for="educationType" class="form-label">نوع التعليم</label>
                                    <select class="form-select" id="educationType" name="educationType" required>
                                        <option value="">اختر نوع التعليم</option>
                                        <option value="أزهري">أزهري</option>
                                        <option value="عام">عام</option>
                                        <option value="أجنبي">أجنبي</option>
                                        <option value="أخرى">أخرى</option>
                                    </select>
                                    <div class="invalid-feedback">يرجى اختيار نوع التعليم</div>
                                </div>

                                <!-- الوظيفة -->
                                <div class="col-md-6 mb-3">
                                    <label for="occupation" class="form-label">الوظيفة (إن وجدت)</label>
                                    <input type="text" class="form-control" id="occupation" name="occupation">
                                </div>

                                <!-- جهة العمل -->
                                <div class="col-md-6 mb-3">
                                    <label for="workPlace" class="form-label">جهة العمل (خاص بالموظفين)</label>
                                    <input type="text" class="form-control" id="workPlace" name="workPlace">
                                </div>

                                <!-- الكلية -->
                                <div class="col-md-6 mb-3">
                                    <label for="college" class="form-label">الكلية (خاص بالطلاب)</label>
                                    <input type="text" class="form-control" id="college" name="college">
                                </div>

                                <!-- السنة الدراسية -->
                                <div class="col-md-6 mb-3">
                                    <label for="academicYear" class="form-label">الفرقة - السنة الدراسية (خاص بالطلاب)</label>
                                    <input type="text" class="form-control" id="academicYear" name="academicYear">
                                </div>

                                <!-- المرحلة -->
                                <div class="col-md-6 mb-3">
                                    <label for="level" class="form-label">المرحلة</label>
                                    <select class="form-select" id="level" name="level" required>
                                        <option value="">اختر المرحلة</option>
                                        <option value="preliminary">تمهيدية</option>
                                        <option value="intermediate">متوسطة</option>
                                        <option value="specialized">تخصصية</option>
                                    </select>
                                    <div class="invalid-feedback">يرجى اختيار المرحلة</div>
                                </div>

                                <!-- قسم المرحلة التخصصية -->
                                <div class="col-md-6 mb-3 d-none" id="specializedDepartmentContainer">
                                    <label for="specializedDepartment" class="form-label">قسم المرحلة التخصصية</label>
                                    <input type="text" class="form-control" id="specializedDepartment" name="specializedDepartment">
                                    <div class="invalid-feedback">يرجى إدخال قسم المرحلة التخصصية</div>
                                </div>

                                <!-- المذهب -->
                                <div class="col-md-6 mb-3">
                                    <label for="doctrine" class="form-label">المذهب</label>
                                    <select class="form-select" id="doctrine" name="doctrine" required>
                                        <option value="">اختر المذهب</option>
                                        <option value="شافعي">شافعي</option>
                                        <option value="حنفي">حنفي</option>
                                        <option value="مالكي">مالكي</option>
                                        <option value="حنبلي">حنبلي</option>
                                        <option value="أخرى">أخرى</option>
                                    </select>
                                    <div class="invalid-feedback">يرجى اختيار المذهب</div>
                                </div>

                                <!-- نوع الدراسة -->
                                <div class="col-md-6 mb-3">
                                    <label for="attendanceSystem" class="form-label">نوع الدراسة</label>
                                    <select class="form-select" id="attendanceSystem" name="attendanceSystem" required>
                                        <option value="">اختر نوع الدراسة</option>
                                        <option value="inPerson">مباشر</option>
                                        <option value="online">عن بعد</option>
                                    </select>
                                    <div class="invalid-feedback">يرجى اختيار نوع الدراسة</div>
                                </div>

                                <!-- من ذوي الهمم -->
                                <div class="col-md-6 mb-3">
                                    <div class="form-check mt-4">
                                        <input class="form-check-input" type="checkbox" id="specialNeeds" name="specialNeeds">
                                        <label class="form-check-label" for="specialNeeds">
                                            من ذوي الهمم
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <h3 class="mt-4 mb-3 border-bottom pb-2">المستندات المطلوبة</h3>
                            <div class="row">
                                <!-- صورة البطاقة -->
                                <div class="col-md-6 mb-3">
                                    <label for="idCardImage" class="form-label">صورة البطاقة (وجه وظهر)</label>
                                    <div class="input-group">
                                        <input type="file" class="form-control" id="idCardImage" name="idCardImage" accept="image/*" required>
                                        <label class="input-group-text" for="idCardImage">
                                            <i class="fas fa-upload"></i>
                                        </label>
                                    </div>
                                    <div class="mt-2 d-none" id="idCardPreviewContainer">
                                        <img id="idCardPreview" class="img-thumbnail" style="max-height: 150px;" alt="معاينة صورة البطاقة">
                                    </div>
                                    <div class="invalid-feedback">يرجى اختيار صورة البطاقة</div>
                                </div>

                                <!-- صورة المؤهل -->
                                <div class="col-md-6 mb-3">
                                    <label for="qualificationImage" class="form-label">
                                        صورة المؤهل
                                        <span id="qualificationRequired" class="text-muted">(مطلوب للمرحلة المتوسطة والتخصصية)</span>
                                    </label>
                                    <div class="input-group">
                                        <input type="file" class="form-control" id="qualificationImage" name="qualificationImage" accept="image/*">
                                        <label class="input-group-text" for="qualificationImage">
                                            <i class="fas fa-upload"></i>
                                        </label>
                                    </div>
                                    <div class="mt-2 d-none" id="qualificationPreviewContainer">
                                        <img id="qualificationPreview" class="img-thumbnail" style="max-height: 150px;" alt="معاينة صورة المؤهل">
                                    </div>
                                    <div class="invalid-feedback">يرجى اختيار صورة المؤهل</div>
                                </div>

                                <!-- صورة ايصال الدفع -->
                                <div class="col-md-6 mb-3">
                                    <label for="paymentReceiptImage" class="form-label">صورة ايصال الدفع</label>
                                    <div class="input-group">
                                        <input type="file" class="form-control" id="paymentReceiptImage" name="paymentReceiptImage" accept="image/*" required>
                                        <label class="input-group-text" for="paymentReceiptImage">
                                            <i class="fas fa-upload"></i>
                                        </label>
                                    </div>
                                    <div class="mt-2 d-none" id="paymentReceiptPreviewContainer">
                                        <img id="paymentReceiptPreview" class="img-thumbnail" style="max-height: 150px;" alt="معاينة صورة ايصال الدفع">
                                    </div>
                                    <div class="invalid-feedback">يرجى اختيار صورة ايصال الدفع</div>
                                </div>

                                <!-- الرقم المرجعي لايصال الدفع -->
                                <div class="col-md-6 mb-3">
                                    <label for="paymentReferenceNumber" class="form-label">الرقم المرجعي لايصال الدفع</label>
                                    <input type="text" class="form-control" id="paymentReferenceNumber" name="paymentReferenceNumber" required>
                                    <div class="invalid-feedback">يرجى إدخال الرقم المرجعي لايصال الدفع</div>
                                </div>
                            </div>

                            <div class="mt-4">
                                <div class="row">
                                    <div class="col-md-6 mb-2">
                                        <button type="submit" class="btn btn-primary w-100 py-3" id="submitButton">
                                            <span id="submitText">تسجيل البيانات</span>
                                            <span id="loadingSpinner" class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                                        </button>
                                    </div>
                                    <div class="col-md-6 mb-2">
                                        <button type="button" class="btn btn-success w-100 py-3 d-none" id="updateButton">
                                            <span id="updateText">تعديل البيانات</span>
                                            <span id="updateSpinner" class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                                        </button>
                                    </div>
                                </div>
                                <input type="hidden" id="studentId" value="">
                                <input type="hidden" id="formMode" value="new">
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="supabase.js"></script>
    <script src="script.js"></script>
</body>
</html>
